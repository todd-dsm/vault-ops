#!/usr/bin/env bash
#  PURPOSE: proxy out to kubernetes
# -----------------------------------------------------------------------------
#  PREREQS: a)
#           b)
#           c)
# -----------------------------------------------------------------------------
#  EXECUTE:
# -----------------------------------------------------------------------------
#     TODO: 1)
#           2)
#           3)
# -----------------------------------------------------------------------------
#   AUTHOR: Todd E Thomas
# -----------------------------------------------------------------------------
#  CREATED: 2018/09/00
# -----------------------------------------------------------------------------
set -x

###----------------------------------------------------------------------------
### VARIABLES
###----------------------------------------------------------------------------
# ENV Stuff
releaseName="$1"


###----------------------------------------------------------------------------
### FUNCTIONS
###----------------------------------------------------------------------------


###----------------------------------------------------------------------------
### MAIN PROGRAM
###----------------------------------------------------------------------------
### Try-catch: Port-forward to the unopened endpoint: myRelease, then
### later, access the vault by initializing and unsealing
###---
{
    kubectl -n default get vault "$releaseName" \
        -o jsonpath='{.status.vaultStatus.sealed[0]}' | \
        xargs -0 -I {} kubectl -n default port-forward {} 8200&
} > /dev/null


###---
### REQ
###---


###---
### fin~
###---
exit 0
